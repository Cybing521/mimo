# MIMO天线位置优化与信道容量仿真

## 项目概述

本项目是一个MIMO（多输入多输出）无线通信系统的天线位置优化仿真程序，主要研究接收天线位置对系统信道容量的影响。

## Untitled1.m 文件内容说明

### 主要功能

该MATLAB脚本实现了一个基于交替优化（Alternating Optimization）的MIMO系统信道容量最大化算法，通过联合优化发送功率分配和接收天线位置来提升系统性能。

### 核心算法流程

1. **参数设置**
   - 归一化区域大小 A/λ: 1~8
   - 试验次数: 1000次
   - 散射体数量 Lr: [15, 10]
   - 发送天线数 N: 4
   - 接收天线数 M: 4
   - 散射体数量 Lt: 10
   - 信噪比 SNR: 15 dB

2. **天线初始化**
   - 在正方形区域内随机生成满足最小距离约束（D = λ/2）的接收天线位置
   - 使用随机采样+验证的方式确保天线间距不小于最小距离

3. **信道建模**
   - 使用级联信道模型: H_r = F' * Σ * G
   - G: 发送端阵列响应矩阵（Lt × N）
   - Σ: 散射矩阵（Lr × Lt），对角线元素为复高斯随机变量
   - F: 接收端阵列响应矩阵（Lr × M），与接收天线位置相关

4. **交替优化迭代**（最多50次外循环）
   
   a. **功率分配优化**（使用CVX）
      - 优化目标: 最大化信道容量 log_det(I + (1/σ²)H_r·Q·H_r')
      - 约束条件: trace(Q) ≤ power, Q ≥ 0（半正定）
   
   b. **天线位置优化**（对每个接收天线进行SCA优化，最多60次内循环）
      - 计算梯度 ∇g 和 Hessian 近似 δ_m
      - 梯度更新: r_new = ∇g/δ_m + r_old
      - 可行性检查:
        * 边界约束: 0 ≤ r ≤ square_size
        * 距离约束: ||r_i - r_j|| ≥ D
      - 若不可行，使用二次规划（quadprog）求解约束优化问题
      - 收敛判据: |obj_current - obj_previous| < 1e-4

5. **收敛判定**
   - 外循环收敛条件: |capacity_current - capacity_previous| < 1e-3
   - 最多迭代50次

6. **结果统计与绘图**
   - 对每个(A/λ, Lr)参数组合进行1000次蒙特卡洛试验
   - 计算平均信道容量
   - 绘制容量vs归一化区域大小曲线（Lr=15和Lr=10两条曲线）

### 关键函数

1. **calculate_F(theta_q, phi_q, lambda, r, f_r_m)**
   - 计算接收端阵列响应矩阵F
   - 基于天线位置和散射体角度计算相位响应

2. **calculate_B_m(G, Q, H_r, m0, sigma, Sigma)**
   - 计算天线位置优化的目标函数矩阵B_m
   - 通过矩阵分解避免直接求逆

3. **calculate_gradients(B_m, f_rm, r_mi, lambda, theta_qi, phi_qi)**
   - 计算目标函数关于天线位置的梯度
   - 计算Hessian矩阵的对角近似δ_m

4. **compute_field_response(r, theta_q, phi_q, lambda)**
   - 计算单个天线位置的场响应向量

### 算法特点

- **交替优化**: 功率分配和位置优化交替进行，直到收敛
- **凸优化**: 功率分配问题为凸优化，使用CVX求解全局最优
- **逐次凸近似(SCA)**: 天线位置优化为非凸问题，通过SCA方法转化为一系列凸二次规划问题
- **约束处理**: 同时考虑边界约束和最小距离约束，保证物理可实现性

### 应用场景

该仿真可用于研究：
- 接收区域大小对MIMO系统容量的影响
- 散射体数量对系统性能的影响
- 天线位置优化算法的收敛性和有效性
- 智能反射面（RIS）辅助通信系统的性能分析

## Python复现说明

本项目提供了两个Python版本：

1. **mimo_exact_reproduction.py**: 完全按照MATLAB逻辑复现（包括原有的问题）
2. **mimo_optimized.py**: 优化版本，修复原代码的问题并提供改进

详细说明见各脚本文件的文档字符串。
